<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><script>! function (n) {
            "use strict";

            function t(n, t) {
                var r = (65535 & n) + (65535 & t);
                return (n >> 16) + (t >> 16) + (r >> 16) << 16 | 65535 & r
            }

            function r(n, t) {
                return n << t | n >>> 32 - t
            }

            function e(n, e, o, u, c, f) {
                return t(r(t(t(e, n), t(u, f)), c), o)
            }

            function o(n, t, r, o, u, c, f) {
                return e(t & r | ~t & o, n, t, u, c, f)
            }

            function u(n, t, r, o, u, c, f) {
                return e(t & o | r & ~o, n, t, u, c, f)
            }

            function c(n, t, r, o, u, c, f) {
                return e(t ^ r ^ o, n, t, u, c, f)
            }

            function f(n, t, r, o, u, c, f) {
                return e(r ^ (t | ~o), n, t, u, c, f)
            }

            function i(n, r) {
                n[r >> 5] |= 128 << r % 32, n[14 + (r + 64 >>> 9 << 4)] = r;
                var e, i, a, d, h, l = 1732584193,
                    g = -271733879,
                    v = -1732584194,
                    m = 271733878;
                for (e = 0; e < n.length; e += 16) i = l, a = g, d = v, h = m, g = f(g = f(g = f(g = f(g = c(g = c(g =
                    c(g = c(g = u(g = u(g = u(g = u(g = o(g = o(g = o(g = o(g, v = o(v, m = o(m,
                                                    l = o(l, g, v, m, n[e], 7, -
                                                        680876936), g, v, n[e +
                                                        1], 12, -389564586), l,
                                                g, n[e + 2], 17, 606105819), m,
                                            l, n[e + 3], 22, -1044525330), v =
                                        o(v, m = o(m, l = o(l, g, v, m, n[e +
                                                4], 7, -176418897), g, v, n[
                                                e + 5], 12, 1200080426), l, g,
                                            n[e + 6], 17, -1473231341), m, l, n[
                                            e + 7], 22, -45705983), v = o(v, m =
                                        o(m, l = o(l, g, v, m, n[e + 8], 7,
                                                1770035416), g, v, n[e + 9], 12,
                                            -1958414417), l, g, n[e + 10], 17, -
                                        42063), m, l, n[e + 11], 22, -
                                    1990404162), v = o(v, m = o(m, l = o(l, g,
                                        v, m, n[e + 12], 7, 1804603682), g,
                                    v, n[e + 13], 12, -40341101), l, g, n[
                                    e + 14], 17, -1502002290), m, l, n[e + 15],
                                22, 1236535329), v = u(v, m = u(m, l = u(l, g,
                                    v, m, n[e + 1], 5, -165796510), g, v, n[
                                    e + 6], 9, -1069501632), l, g, n[e + 11],
                                14, 643717713), m, l, n[e], 20, -373897302), v = u(
                                v, m = u(m, l = u(l, g, v, m, n[e + 5], 5, -
                                    701558691), g, v, n[e + 10], 9, 38016083), l, g,
                                n[e + 15], 14, -660478335), m, l, n[e + 4], 20, -
                            405537848), v = u(v, m = u(m, l = u(l, g, v, m, n[e +
                                9], 5, 568446438), g, v, n[e + 14], 9, -
                            1019803690), l, g, n[e + 3], 14, -187363961), m, l, n[
                            e + 8], 20, 1163531501), v = u(v, m = u(m, l = u(l, g, v, m,
                                n[e + 13], 5, -1444681467), g, v, n[e + 2], 9, -
                            51403784), l, g, n[e + 7], 14, 1735328473), m, l, n[e + 12],
                        20, -1926607734), v = c(v, m = c(m, l = c(l, g, v, m, n[e + 5],
                        4, -378558), g, v, n[e + 8], 11, -2022574463), l, g, n[e +
                        11], 16, 1839030562), m, l, n[e + 14], 23, -35309556), v = c(v, m =
                        c(m, l = c(l, g, v, m, n[e + 1], 4, -1530992060), g, v, n[e + 4],
                            11, 1272893353), l, g, n[e + 7], 16, -155497632), m, l, n[e +
                        10], 23, -1094730640), v = c(v, m = c(m, l = c(l, g, v, m, n[e + 13], 4,
                            681279174), g, v, n[e], 11, -358537222), l, g, n[e + 3], 16, -
                        722521979), m, l, n[e + 6], 23, 76029189), v = c(v, m = c(m, l = c(l, g,
                        v, m, n[e + 9], 4, -640364487), g, v, n[e + 12], 11, -421815835), l, g,
                    n[e + 15], 16, 530742520), m, l, n[e + 2], 23, -995338651), v = f(v, m = f(m,
                        l = f(l, g, v, m, n[e], 6, -198630844), g, v, n[e + 7], 10, 1126891415), l,
                    g, n[e + 14], 15, -1416354905), m, l, n[e + 5], 21, -57434055), v = f(v, m = f(m,
                        l = f(l, g, v, m, n[e + 12], 6, 1700485571), g, v, n[e + 3], 10, -1894986606),
                    l, g, n[e + 10], 15, -1051523), m, l, n[e + 1], 21, -2054922799), v = f(v, m = f(m, l =
                    f(l, g, v, m, n[e + 8], 6, 1873313359), g, v, n[e + 15], 10, -30611744), l, g, n[e +
                    6], 15, -1560198380), m, l, n[e + 13], 21, 1309151649), v = f(v, m = f(m, l = f(l, g, v, m,
                        n[e + 4], 6, -145523070), g, v, n[e + 11], 10, -1120210379), l, g, n[e + 2], 15,
                    718787259), m, l, n[e + 9], 21, -343485551), l = t(l, i), g = t(g, a), v = t(v, d), m = t(m, h);
                return [l, g, v, m]
            }

            function a(n) {
                var t, r = "",
                    e = 32 * n.length;
                for (t = 0; t < e; t += 8) r += String.fromCharCode(n[t >> 5] >>> t % 32 & 255);
                return r
            }

            function d(n) {
                var t, r = [];
                for (r[(n.length >> 2) - 1] = void 0, t = 0; t < r.length; t += 1) r[t] = 0;
                var e = 8 * n.length;
                for (t = 0; t < e; t += 8) r[t >> 5] |= (255 & n.charCodeAt(t / 8)) << t % 32;
                return r
            }

            function h(n) {
                return a(i(d(n), 8 * n.length))
            }

            function l(n, t) {
                var r, e, o = d(n),
                    u = [],
                    c = [];
                for (u[15] = c[15] = void 0, o.length > 16 && (o = i(o, 8 * n.length)), r = 0; r < 16; r += 1) u[r] =
                    909522486 ^ o[r], c[r] = 1549556828 ^ o[r];
                return e = i(u.concat(d(t)), 512 + 8 * t.length), a(i(c.concat(e), 640))
            }

            function g(n) {
                var t, r, e = "";
                for (r = 0; r < n.length; r += 1) t = n.charCodeAt(r), e += "0123456789abcdef".charAt(t >>> 4 & 15) +
                    "0123456789abcdef".charAt(15 & t);
                return e
            }

            function v(n) {
                return unescape(encodeURIComponent(n))
            }

            function m(n) {
                return h(v(n))
            }

            function p(n) {
                return g(m(n))
            }

            function s(n, t) {
                return l(v(n), v(t))
            }

            function C(n, t) {
                return g(s(n, t))
            }

            function A(n, t, r) {
                return t ? r ? s(t, n) : C(t, n) : r ? m(n) : p(n)
            }

            "function" == typeof define && define.amd ? define(function () {
                return A
            }) : "object" == typeof module && module.exports ? module.exports = A : n.md5 = A
        }(this);</script></head><style>video {
        width: 300px;
    }

    span {
        display: inline-block;
        width: 100px;
    }</style><body><p><span>userId:</span> <input id="user_id" value="15500010004"></p><p><span>password:</span> <input id="pwd" value="123456"></p><p><span>meetingId:</span> <input id="meetingId" value="70018676"></p><p><span>getwayIP:</span> <input id="getwayIP" value="192.168.1.189"></p><p><span>port:</span> <input id="port" value="3000"></p><button id="init" onclick="init()">初始化</button> <button id="create_meeting" onclick="create_meeting()">创建会议</button> <button id="join_meeting" onclick="join_meeting()">加入会议</button> <button id="leave_meeting" onclick="leave_meeting()">退出会议</button> <button id="ask_speak" onclick="ask_speak()">请求发言</button> <button onclick="ask_for_stop_speak()">请求停止发言</button> <button onclick="SetSpeaker()">指定发言人</button> <button onclick="openCamera()">打开摄像头</button> <button onclick="closeCamera()">关闭摄像头</button> <button onclick="RaiseHand()">用户举手请求发言</button> <button onclick="GetAllUsers()">获取会议室所有成员</button> <button onclick="SendUIMsg()">发送UI信息</button><div><button onclick="StartLocalPreview()">启动本地预览</button></div><p>订阅</p><ul id="subscribe" onclick="subscribe(event)"></ul><p>取消订阅</p><ul id="unsubscribe" onclick="unsubscribe(event)"></ul><p>收到服务器通知</p><ul id="notify"></ul><script>var instance;
        var speakerList; // 发言人列表
        var meetingId = document.getElementById('meetingId').value;
        var userId = document.getElementById('user_id').value;
        var pwd = document.getElementById('pwd').value;
        var getwayIP = document.getElementById('getwayIP').value;
        var port = document.getElementById('port').value;



        function init() {
            instance = window["ButelRTCSDK"].CreateInstance();
            SetConfig(getwayIP, port)
            instance.Init(userId, md5(pwd), () => {}, () => {});
            startListens();

        }

        function SetConfig(getwayIP, port) {
            instance.SetConfig({
                hostname: getwayIP,
                listenPort: port
            });
        }

        var clickUser = null;

        function subscribe(event) {
            const userId = event.target.innerHTML;
            const dom = document.createElement('div');
            document.body.appendChild(dom);
            instance.StartRemoteVideo(userId, dom);

            document.getElementById('unsubscribe').appendChild(event.target);

        }

        function unsubscribe(event) {

            const userId = event.target.innerHTML;
            instance.StopRemoteVideo(userId);

            document.getElementById('subscribe').appendChild(event.target);

        }

        function create_meeting() {
            instance.CreateMeeting((res) => {
                console.log('创建会议成功 ', res);
                meetingId = res;
                document.getElementById('meetingId').value = res;
            }, err => {
                console.log('创建会议失败 ', err);

            })
        }


        function join_meeting() {
            instance.JoinMeeting(userId, meetingId, false, 'ltj', (res) => {
                console.log('success', res);
                speakerList = res.speakerList;
                var innerHTML = '';
                res.speakerList.forEach(item => {
                    const dom = document.createElement('div');
                    document.body.appendChild(dom);
                    instance.StartRemoteVideo(item.userid, dom);

                    innerHTML += `<li>${item.userid}</li>`;

                })
                document.getElementById('unsubscribe').innerHTML = innerHTML;
            }, (err) => {
                console.log('error', err);

            });
        }

        function leave_meeting() {
            instance.LeaveMeeting(() => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function ask_speak() {
            instance.AskForSpeak(() => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function ask_for_stop_speak() {
            instance.AskForStopSpeak(() => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function GetAllUsers() {
            instance.GetAllUsers(() => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function SendUIMsg() {
            instance.SendUIMsg(myUserId, '34535', 'hello', () => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function SetSpeaker() {
            instance.SetSpeaker('90400789', '', () => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function KickoutUser() {
            instance.KickoutUser(myUserId, () => {
                console.log('success');

            }, () => {
                console.log('error');

            });
        }

        function openCamera() {
            instance.EnableCamera(1, (res) => {
                console.log('打开摄像头成功', res);

            }, (err) => {
                console.log('打开摄像头失败', err);

            })
        }

        function closeCamera() {
            instance.EnableCamera(0, (res) => {
                console.log('关闭摄像头成功', res);

            }, (err) => {
                console.log('关闭摄像头失败', err);

            })
        }

        function RaiseHand() {
            instance.RaiseHand(0, (res) => {
                console.log('用户举手请求发言成功', res);

            }, (err) => {
                console.log('用户举手请求发言失败', err);

            })
        }

        function StartLocalPreview() {
            const dom = document.createElement('div');
            document.body.appendChild(dom)
            instance.StartLocalPreview(dom);
        }

        function startListens() {
            instance.on("onStartSpeak", (res) => {
                console.log('onStartSpeak', res);
                const dom = document.createElement('div');
                document.body.appendChild(dom)
                if (res.userId && myUserId !== res.userId) {
                    instance.StartRemoteVideo(res.userId, dom);
                } else {
                    instance.StartLocalPreview(dom);
                }


            });
            instance.on("onStopSpeak", (res) => {
                console.log('onStopSpeak', res);
                if (res.userId && myUserId === res.userId) {
                    instance.StopLocalPreview(res.userId);
                } else {
                    instance.StopRemoteVideo(res.userId);
                }

            });
            instance.on("onMeetingEnd", (res) => {
                console.log('onMeetingEnd', res);

            });
            instance.on("onKickout", (res) => {
                console.log('onKickout', res);

            });
            instance.on("onUserJoin", (res) => {
                console.log('onUserJoin', res);

            });
            instance.on("onUserLeave", (res) => {
                console.log('onUserLeave', res);

            });
            instance.on("onUserOpenCamera", (res) => {
                console.log('onUserOpenCamera', res);
            });
            instance.on("onUserCloseCamera", (res) => {
                console.log('onUserCloseCamera', res);

            });
            instance.on("onUserOpenMic", (res) => {
                console.log('onUserOpenMic', res);

            });
            instance.on("onUserCloseMic", (res) => {
                console.log('onUserCloseMic', res);

            });
            instance.on("onUserOpenShare", (res) => {
                console.log('onUserOpenShare', res);

            });
            instance.on("onUserCloseShare", (res) => {
                console.log('onUserCloseShare', res);

            });
            instance.on("onMeetingModeChange", (res) => {
                console.log('onMeetingModeChange', res);

            });
            instance.on("onHostControl", (res) => {
                console.log('onHostControl', res);

            });
            instance.on("onRaiseHand", (res) => {
                console.log('onRaiseHand', res);

            });
            instance.on("onMeetingRestore", (res) => {
                console.log('onMeetingRestore', res);

            });
            instance.on("onHostTransfer", (res) => {
                console.log('onHostTransfer', res);

            });
            instance.on("onHostTransfer", (res) => {
                console.log('onHostTransfer', res);

            });
            instance.on("onRecvUIMsg", (res) => {
                console.log('onRecvUIMsg', res);

            });
            instance.on("onRemoteSpeakerForMaxVol", (res) => {
                console.log('onRemoteSpeakerForMaxVol', res);

            });


        }</script><script src="RTCMeetingConnect_SDK.js"></script></body></html>